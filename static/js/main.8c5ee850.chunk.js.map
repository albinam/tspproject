{"version":3,"sources":["ga/GA.js","Map/Marker.js","ga/Popup.js","ga/TSP.js","App.js","reportWebVitals.js","index.js"],"names":["distance","x1","y1","x2","y2","dLat","Math","PI","dLng","a","sin","cos","d","atan2","sqrt","round","calculateFitness","graph","chromosome","totalDist","i","path","length","lat","lng","shuffleArray","array","j","floor","random","temp","getInitialGeneration","n","points","population","Array","from","_","fitness","unshift","push","crossingover","newPopulation","l","p1","p2","chromosomeLength","childPath","fill","randomArraySelector","slice","sort","vis","k","childChromosome","mutation","mutatedPopulation","b","GA","generations","initialPopulation","gen","concat","splice","result","size","Marker","index","className","Popup","props","onClick","handleClose","content","Option","Select","TSP","useState","gaSteps","setGASteps","status","setStatus","speed","setSpeed","setGenerations","setInitialPopulation","data","setData","map","setMap","maps","setMaps","dur","setDuration","dis","setDistance","travelMode","setTravelMode","markers","setMarker","canDraw","setCanDraw","p","useRef","isOpen","setIsOpen","togglePopup","clear","current","useEffect","localeCompare","interval","setInterval","next","done","state","value","clearInterval","min","max","onChange","val","defaultValue","type","disabled","e","preventDefault","style","marginTop","height","width","bootstrapURLKeys","key","process","center","defaultZoom","ev","coords","id","alert","onGoogleApiLoaded","onMapLoaded","obj","markersDisplay","paths","nonGeodesicPolyline","Polyline","geodesic","strokeColor","strokeOpacity","strokeWeight","lines","plot","directionsService","DirectionsService","directionsDisplay","DirectionsRenderer","setOptions","suppressMarkers","waypts","location","stopover","directions","request","origin","destination","waypoints","avoidHighways","avoidTolls","optimizeWaypoints","provideRouteAlternatives","duration","route","response","DirectionsStatus","OK","setDirections","routes","legs","resp","parseInt","ceil","getPath","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.8c5ee850.chunk.js","sourcesContent":["const distance = (x1, y1, x2, y2) => {\r\n    let R = 6378137;\r\n    let dLat = (x2-x1) * Math.PI / 180;\r\n    let dLng = (y1-y2) * Math.PI / 180;\r\n    let a = Math.sin(dLat/2) * Math.sin(dLat/2) +\r\n        Math.cos(x1 * Math.PI / 180 ) * Math.cos(x2 * Math.PI / 180 ) *\r\n        Math.sin(dLng/2) * Math.sin(dLng/2);\r\n    let c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));\r\n    let d = R * c;\r\n    return Math.round(d);\r\n};\r\nconst calculateFitness = (graph, chromosome) => {\r\n    let totalDist = 0;\r\n    for (let i = 0; i < chromosome.path.length - 1; i++) {\r\n        if (graph[chromosome.path[i]] && graph[chromosome.path[i + 1]]) {\r\n            totalDist += distance(graph[chromosome.path[i]]?.lat, graph[chromosome.path[i]]?.lng, graph[chromosome.path[i + 1]]?.lat, graph[chromosome.path[i + 1]]?.lng);\r\n        }\r\n    }\r\n    return totalDist;\r\n};\r\n\r\nfunction shuffleArray(array) {\r\n    for (let i = array.length - 1; i > 0; i--) {\r\n        let j = Math.floor(Math.random() * (i + 1));\r\n        let temp = array[i];\r\n        array[i] = array[j];\r\n        array[j] = temp;\r\n    }\r\n    return array;\r\n}\r\n\r\nconst getInitialGeneration = (n, points, graph) => {\r\n    const population = [];\r\n    for (let i = 0; i < n; i++) {\r\n        const chromosome = {\r\n            path: shuffleArray(Array.from({length: points - 1}, (_, i) => i + 1)),\r\n            fitness: 0,\r\n        };\r\n        chromosome.path.unshift(0);\r\n        chromosome.path.push(0);\r\n        chromosome.fitness = calculateFitness(graph, chromosome);\r\n        population.push({...chromosome});\r\n    }\r\n    return population;\r\n};\r\n//скрещивание\r\nconst crossingover = (population, graph) => {\r\n    population = shuffleArray(population);\r\n    const newPopulation = [];\r\n    const l = population.length;\r\n    for (let i = 0; i < l / 2; i++) {\r\n        //берём симметричные хромосомы в родительской популяции\r\n        const p1 = population[i];\r\n        const p2 = population[l - i - 1];\r\n        const chromosomeLength = p1.path.length;\r\n        //новая хромосома\r\n        const childPath = new Array(p1.path.length).fill(-1);\r\n        //создаем радномный массив индексов\r\n        let randomArraySelector = shuffleArray(\r\n            Array.from({length: chromosomeLength - 2}, (_, i) => i + 1)\r\n        );\r\n        //делим его пополам\r\n        randomArraySelector = randomArraySelector.slice(\r\n            randomArraySelector.length / 2\r\n        );\r\n\r\n        //сортируем\r\n        randomArraySelector.sort();\r\n        const vis = Array(chromosomeLength).fill(false);\r\n        //заполняем по найденным рандомным индексам новую хромосому из первой родительской\r\n        for (let j = 1; j < randomArraySelector.length; j++) {\r\n            childPath[randomArraySelector[j]] = p1.path[randomArraySelector[j]];\r\n            vis[p1.path[randomArraySelector[j]]] = true;\r\n        }\r\n        //там где не заполнили дополняем второй родительской хромосомой\r\n        let k = 0;\r\n        let j = 0;\r\n        while (j < chromosomeLength - 1) {\r\n            if (childPath[j] === -1) {\r\n                if (!vis[p2.path[k]]) {\r\n                    childPath[j] = p2.path[k];\r\n                    j++;\r\n                    k++;\r\n                } else {\r\n                    k++;\r\n                }\r\n            } else {\r\n                j++;\r\n            }\r\n        }\r\n        //возвращаемся в точку отправки\r\n        childPath[chromosomeLength - 1] = 0;\r\n        //добавили к хромосоме расчет фитнес функциии\r\n        const childChromosome = {path: childPath, fitness: 0};\r\n        childChromosome.fitness = calculateFitness(graph, childChromosome);\r\n        newPopulation.push(childChromosome);\r\n    }\r\n\r\n    return newPopulation;\r\n};\r\n//мутация\r\nconst mutation = (newPopulation, graph) => {\r\n    const mutatedPopulation = [];\r\n    let l = newPopulation.length;\r\n    //записали популяцию до мутации\r\n    for (let i = 0; i < l; i++) {\r\n        mutatedPopulation.push({path: [...newPopulation[i].path], fitness: 0});\r\n    }\r\n    for (let i = 0; i < l; i++) {\r\n        const chromosomeLength = mutatedPopulation[i].path.length;\r\n        //рассчитываем два рандомных индекса и меняем местами номера пунктов по этим индексам\r\n        const a = Math.floor(Math.random() * (chromosomeLength - 3)) + 1;\r\n        const b = Math.floor(Math.random() * (chromosomeLength - 3)) + 1;\r\n        const temp = mutatedPopulation[i].path[a];\r\n        mutatedPopulation[i].path[a] = mutatedPopulation[i].path[b];\r\n        mutatedPopulation[i].path[b] = temp;\r\n        mutatedPopulation[i].fitness = calculateFitness(\r\n            graph,\r\n            mutatedPopulation[i]\r\n        );\r\n    }\r\n    return mutatedPopulation;\r\n};\r\n\r\nconst GA = function* (points, graph, generations, initialPopulation) {\r\n    let population = getInitialGeneration(initialPopulation, points, graph);\r\n    for (let gen = 0; gen < generations; gen++) {\r\n        //скрещивание\r\n        const newPopulation = crossingover(population, graph);\r\n\r\n        //мутация\r\n        const mutatedPopulation = mutation(newPopulation, graph);\r\n        population = population.concat(mutatedPopulation);\r\n\r\n        //отбор\r\n        population.sort((a, b) => {\r\n            if (a.fitness < b.fitness) return -1;\r\n            if (a.fitness > b.fitness) return 1;\r\n            return 0;\r\n        });\r\n        population = population.splice(0, initialPopulation);\r\n        yield {result: population[0], size: population.length, gen};\r\n    }\r\n};\r\n\r\nexport default GA;\r\n","import React from 'react';\r\nimport './Marker.scss';\r\n\r\nfunction Marker({index}) {\r\n\r\n    return (\r\n        <div className=\"location-map_marker\">\r\n            <div className=\"location-map_marker_index\">{index}</div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Marker;","import React from \"react\";\r\nimport \"./Popup.scss\"\r\nconst Popup = props => {\r\n    return (\r\n        <div className=\"popup-box\">\r\n            <div className=\"box\">\r\n                <span className=\"close-icon\" onClick={props.handleClose}>x</span>\r\n                {props.content}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Popup;","import React, {useEffect, useRef, useState} from \"react\";\r\nimport {Slider, Button, Select} from 'antd';\r\nimport GA from \"./GA\";\r\nimport Marker from \"../Map/Marker\";\r\nimport \"./TSP.scss\"\r\nimport GoogleMapReact from 'google-map-react';\r\nimport Popup from \"./Popup\";\r\n\r\nconst {Option} = Select;\r\n\r\nfunction TSP() {\r\n    const [gaSteps, setGASteps] = useState(null);\r\n    const [status, setStatus] = useState(\"Paused\");\r\n    const [speed, setSpeed] = useState(300);\r\n    const [generations, setGenerations] = useState(20);\r\n    const [initialPopulation, setInitialPopulation] = useState(10);\r\n    const [data, setData] = useState(null);\r\n    const [map, setMap] = useState();\r\n    const [maps, setMaps] = useState();\r\n    const [dur, setDuration] = useState();\r\n    const [dis, setDistance] = useState();\r\n    const [travelMode, setTravelMode] = useState(\"DRIVING\");\r\n    const [markers, setMarker] = useState([]);\r\n    const [canDraw, setCanDraw] = useState(false);\r\n    const p = useRef([]);\r\n    const d = useRef([]);\r\n    const [isOpen, setIsOpen] = useState(false);\r\n    const key = process.env.REACT_APP_GOOGLE_MAPS_API;\r\n    const defaultZoom = 15;\r\n\r\n    const onClick = (coords) => {\r\n        setMarker([...markers, {id: markers.length, lat: coords.lat, lng: coords.lng}])\r\n        setCanDraw(false)\r\n        if (markers.length > 8) {\r\n            alert(\"Максимально можно добавить только 9 точек\")\r\n            clear()\r\n        }\r\n    }\r\n\r\n    function onMapLoaded(map, maps) {\r\n        setMap(map);\r\n        setMaps(maps);\r\n    }\r\n\r\n    const togglePopup = () => {\r\n        setIsOpen(!isOpen);\r\n    }\r\n    const clear = () => {\r\n        setMarker([]);\r\n        if (p.current) {\r\n            for (let i = 0; i < p.current.length; i++) {\r\n                p.current[i].setMap(null);\r\n            }\r\n        }\r\n        if (d.current[0]) {\r\n            d.current[0].setMap(null);\r\n        }\r\n    }\r\n\r\n    function getPath(result, graph) {\r\n        let directionsService = new maps.DirectionsService();\r\n        let directionsDisplay = new maps.DirectionsRenderer();\r\n        directionsDisplay.setOptions({suppressMarkers: true});\r\n        let waypts = [];\r\n        let l = result ? result.length : 0;\r\n        for (let i = 0; i < l - 1; i++) {\r\n            waypts.push({\r\n                location: graph[result[i]],\r\n                stopover: true\r\n            });\r\n        }\r\n        let directions = [];\r\n        let request = {\r\n            origin: graph[result[0]],\r\n            destination: graph[result[0]],\r\n            waypoints: waypts,\r\n            travelMode: travelMode,\r\n            avoidHighways: false,\r\n            avoidTolls: false,\r\n            optimizeWaypoints: false,\r\n            provideRouteAlternatives: true\r\n        };\r\n        let duration = 0;\r\n        let distance = 0;\r\n        for (let i = 0; i < d.current.length; i++) {\r\n            d.current[i].setMap(null);\r\n        }\r\n        directionsService.route(request, function (response, status) {\r\n            if (status === maps.DirectionsStatus.OK) {\r\n                directionsDisplay.setDirections(response);\r\n                response.routes[0].legs.map(resp => {\r\n                    duration = duration + parseInt(resp.duration.value);\r\n                    distance = distance + parseInt(resp.distance.value);\r\n                })\r\n            }\r\n            setDuration(Math.ceil(duration / 60));\r\n            setDistance(distance)\r\n        });\r\n        directions.push(directionsDisplay)\r\n        d.current = directions;\r\n        directionsDisplay.setMap(map);\r\n    }\r\n\r\n    function markersDisplay() {\r\n        if (markers && markers.length <= 9) {\r\n            return markers.map((obj, index) => (\r\n                <Marker key={index} index={index} lat={obj.lat} lng={obj.lng}/>\r\n            ));\r\n        }\r\n    }\r\n\r\n    const handleClick = () => {\r\n        status.localeCompare(\"Playing\") === 0\r\n            ? setStatus(\"Paused\")\r\n            : setStatus(\"Playing\");\r\n    }\r\n\r\n    const plot = (graph, result) => {\r\n        let paths = [];\r\n        if (markers) {\r\n            let l = result ? result.length : 0;\r\n            for (let i = 0; i < l - 1; i++) {\r\n                paths = [...paths, {lat: graph[result[i]]?.lat, lng: graph[result[i]]?.lng}, {\r\n                    lat: graph[result[i + 1]]?.lat,\r\n                    lng: graph[result[i + 1]]?.lng\r\n                }];\r\n            }\r\n            for (let i = 0; i < p.current.length; i++) {\r\n                p.current[i].setMap(null);\r\n            }\r\n            let nonGeodesicPolyline = new maps.Polyline({\r\n                path: paths,\r\n                geodesic: false,\r\n                strokeColor: \"#430284\",\r\n                strokeOpacity: 0.7,\r\n                strokeWeight: 2\r\n            })\r\n            let lines = []\r\n            lines.push(nonGeodesicPolyline)\r\n            nonGeodesicPolyline.setMap(map);\r\n            p.current = lines;\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        if (markers) {\r\n            setGASteps(GA(markers.length, markers, generations, initialPopulation));\r\n        }\r\n    }, [generations, initialPopulation, markers]);\r\n\r\n    useEffect(() => {\r\n        if (gaSteps != null && status.localeCompare(\"Playing\") === 0) {\r\n            const interval = setInterval(() => {\r\n                const next = gaSteps.next();\r\n                if (next.done) {\r\n                    setStatus(\"Paused\");\r\n                    setGASteps(\r\n                        GA(markers.length, markers, generations, initialPopulation)\r\n                    );\r\n                    setCanDraw(false)\r\n                    return;\r\n                }\r\n                const state = next.value;\r\n                setData(state);\r\n                setCanDraw(true)\r\n            }, speed);\r\n            return () => {\r\n                clearInterval(interval);\r\n            };\r\n        }\r\n    }, [\r\n        gaSteps,\r\n        markers,\r\n        status,\r\n        speed,\r\n        initialPopulation,\r\n        generations\r\n    ]);\r\n\r\n    return (\r\n        <div className=\"main-container\">\r\n            <div className=\"main-container_params\">\r\n                <h3>Решение задачи коммивояжера генетическим алгоритмом</h3>\r\n                <h4>Установите от 2 до 9 точек на карте для начала работа алгоритма</h4>\r\n                <div className=\"main-container_slider\">\r\n                    <div>Количество поколений: {generations}</div>\r\n                    <Slider\r\n                        min={1}\r\n                        max={100}\r\n                        onChange={(val) => {\r\n                            setGenerations(val);\r\n                        }}\r\n                        value={generations}\r\n                    />\r\n                </div>\r\n                <div className=\"main-container_slider\">\r\n                    <div>Начальная популяция: {initialPopulation}</div>\r\n                    <Slider\r\n                        min={1}\r\n                        max={100}\r\n                        onChange={(val) => {\r\n                            setInitialPopulation(val);\r\n                        }}\r\n                        value={initialPopulation}\r\n                    />\r\n                </div>\r\n                <div className=\"main-container_slider\">\r\n                    <div>Скорость: {speed}</div>\r\n                    <Slider\r\n                        min={100}\r\n                        max={2000}\r\n                        value={speed}\r\n                        onChange={(val) => {\r\n                            setSpeed(val);\r\n                        }}\r\n                    />\r\n                </div>\r\n                <div>Способ передвижения</div>\r\n                <Select defaultValue=\"DRIVING\" onChange={(value) => {\r\n                    setTravelMode(value);\r\n                }}>\r\n                    <Option value=\"DRIVING\">На машине</Option>\r\n                    <Option value=\"WALKING\">Пешком</Option>\r\n                </Select>\r\n                <h4>Расстояние, рассчитанное по генетическому алгоритму: {data?.result?.fitness} м</h4>\r\n                <h4>Время в пути: {dur} мин</h4>\r\n                <h4>Расстояние по карте: {dis} м</h4>\r\n                <h4>Найденная последовательность точек: {data?.result?.path}</h4>\r\n                <Button type=\"primary\"\r\n                        disabled={status.localeCompare(\"Playing\") === 0 || markers.length < 2}\r\n                        onClick={(e) => {\r\n                            e.preventDefault();\r\n                            handleClick()\r\n                        }}\r\n                >Начать</Button>\r\n                <Button type=\"primary\"\r\n                        style={{marginTop:'10px'}}\r\n                        onClick={() => clear()}\r\n                >Очистить карту</Button>\r\n                <div className=\"legend\">\r\n                    <div className=\"legend_line\">\r\n                        <div className=\"blue\"/>\r\n                        <div>Путь по карте</div>\r\n                    </div>\r\n                    <div className=\"legend_line\">\r\n                        <div className=\"purple\"/>\r\n                        <div>Путь по генетическому алгоритму</div>\r\n                    </div>\r\n                </div>\r\n\r\n            <Button type=\"primary\"\r\n                    onClick={togglePopup}\r\n                    style={{marginTop:'10px'}}\r\n            >Открыть описание алгоритма</Button>\r\n            {isOpen && <Popup\r\n                content={<>\r\n                    <b>Описание генетического алгоритма</b>\r\n                    <p>Задача коммивояжера задает такой вопрос: «Учитывая список\r\n                        городов и расстояния между каждой парой городов, каков кратчайший\r\n                        возможный маршрут, который включает каждый город и возвращается в\r\n                        исходный город?»\r\n\r\n                    Задача решается использованием генетического алгоритма, в качестве функции приспособленности используется формула\r\n                    гаверсинусов, которая позволяет найти расстояние между двумя географическими координатами.\r\n                    Пользователь задает количество количество поколений, начальную популяцию и величину задержки между поколениями.\r\n                    В результате работы алгоритма находится хромосома, которая содержит в себе точки на карте, в той последовательности,\r\n                    которая имеет наименьшее итоговое расстояние.\r\n                    </p>\r\n                </>}\r\n                handleClose={togglePopup}\r\n            />}\r\n            </div>\r\n\r\n            <div className=\"main-container_map\" style={{height: '100vh', width: '100%'}}>\r\n                <GoogleMapReact\r\n                    bootstrapURLKeys={{key: key}}\r\n                    center={{\r\n                        lat: 54.3399097,\r\n                        lng: 48.3826817\r\n                    }}\r\n                    defaultZoom={defaultZoom}\r\n                    onClick={ev => onClick(ev)}\r\n                    onGoogleApiLoaded={({map, maps}) => onMapLoaded(map, maps)}>\r\n                    {markersDisplay()}\r\n                    {(canDraw) ? plot(markers, data.result.path) : null}\r\n                    {(data?.result?.path && status.localeCompare(\"Paused\") === 0) ? getPath(data?.result?.path, markers) : null}\r\n                </GoogleMapReact>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default TSP;\r\n","import './App.css';\nimport TSP from \"./ga/TSP\";\nimport 'antd/dist/antd.css';\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <TSP/>\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}